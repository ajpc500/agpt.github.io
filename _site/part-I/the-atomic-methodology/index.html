<!doctype html>
<html lang="en-US"><head>
   <meta charset="utf-8">
    <!-- Chulapa Jekyll Theme -  -->
    <!--  MIT License-->
    <!-- Docs: https://dieghernan.github.io/chulapa -->
    <!-- Repo: https://github.com/dieghernan/chulapa -->
    <!-- Page build 2025-02-24 20:58:58 +0000 -->
     <!-- Jekyll Version 3.10.0 -->
    <!--Google Structured Data-->
    <script type="application/ld+json">
        {
      "@context": "https://schema.org",
	  "@type": "Article",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://localhost:4000/part-I/the-atomic-methodology/"
      },
      "headline": "The Atomic Methodology",
      "image": "https://github.com/ajpc500.png",
      "datePublished": "2025-02-24T20:58:58+00:00",
      "dateModified": "2025-02-24T20:58:58+00:00",
      "author": {
        "@type": "Person",
        "name": "ajpc500"
      },
       "publisher": {
        "@type": "Organization",
        "name": "ajpc500",
        "url": "http://localhost:4000/",
        "logo": {
          "@type": "ImageObject",
          "url": "https://github.com/ajpc500.png"
        }
      }
    }
    </script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "http://localhost:4000/"
      },{
        "@type": "ListItem",
        "position": 2,
        "name": "The Atomic Methodology"
      }]
    }
    </script>
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "name": "The Atomic Methodology",
    "description": ""
    }
}
</script><script type="application/ld+json">
{
  "@context" : "https://schema.org",
  "@type" : "Person",
  "homeLocation": {
    "@type": "Place",
    "name": "London, United Kingdom"
    },
  "description": "Publisher",
  "name" : "ajpc500",
  "url" : "http://localhost:4000/"
}
</script>
   <title>The Atomic Methodology | A Guide to Purple Teaming</title>
  <link rel="canonical" href="http://localhost:4000/part-I/the-atomic-methodology/">
    <!-- Atom feed -->
  <link href="http://localhost:4000/atom.xml" type="application/atom+xml" rel="alternate" title="Atom feed A Guide to Purple Teaming" >
    <!-- RSS 2.0 feed -->
  <link href="http://localhost:4000/rss.xml" type="application/rss+xml" rel="alternate" title="RSS 2.0 feed A Guide to Purple Teaming" >
    <!-- Meta tags -->
   <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
   <meta name="author" content="ajpc500" >
   <meta name="copyright" content="ajpc500" >
   <meta name="description" content="">
   <meta name="thumbnail" content="https://github.com/ajpc500.png" >
   <meta name="robots" content="index, follow"><meta name="keywords" content="">
    <!-- Chrome, Firefox OS and Opera -->
  <meta name="theme-color" content="#000000">
    <!-- OpenGraph -->
   <meta property="og:title" content="The Atomic Methodology | A Guide to Purple Teaming" >
   <meta property="og:site_name" content="A Guide to Purple Teaming | A Guide to Purple Teaming" >
   <meta property="og:url" content="http://localhost:4000/part-I/the-atomic-methodology/" >
   <meta property="og:type" content="website" >
   <meta property="og:description" content="" >
   <meta property="og:locale" content="en-US" >
   <meta property="og:image" content="https://github.com/ajpc500.png" >
    <!-- Twitter/X Cards -->
   <meta name="twitter:card" content="summary_large_image"><!-- start custom head snippets -->
<!-- this script is inserted before the css stylesheet -->
<!-- end custom head snippets -->
<!-- CSS -->
    <!-- Preconnect with Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Fontawesome-->
    <!-- v6 -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css">
  <link rel="preload" href="https://cdn.jsdelivr.net/gh/dieghernan/chulapa@master/assets/js/chulapa_script.js" as="script" >
  <link rel="preload" href="https://cdn.jsdelivr.net/gh/dieghernan/chulapa@master/assets/fonts/Chulapa/Chulapa-Bold_vmod.otf" as="font" type="font/otf" crossorigin>
    <!-- Theme css (Bootstrap included) -->
  <link rel="stylesheet" id="maincss" href="http://localhost:4000/assets/css/main.css" >
    <!-- Highlighter -->
  <link id="csshigh" rel="stylesheet" href="http://localhost:4000/assets/css/highlighter.css" >
    <!-- Custom css -->
  <link rel="stylesheet" href="http://localhost:4000/assets/css/custom.css" >
      <!-- start custom head snippets -->
<!-- insert favicons. use https://realfavicongenerator.net/ -->
<!-- end custom head snippets -->
</head>
<body class="d-flex flex-column h-entry" id="body">
	<a class="u-url d-none" href="http://localhost:4000/part-I/the-atomic-methodology/">Invisible link to canonical for Microformats</a>
	<div class="navbar-chulapa-fab">
		<input type="checkbox" class="navbar-chulapa-fab-button d-none" id="navi-toggle">
		<label for="navi-toggle" class="navbar-toggler p-1 m-0 text-center d-flex">
			<span class="navbar-toggler-icon m-auto">&nbsp;</span>
		</label>
		<div class="navbar-chulapa-fab-background">&nbsp;</div>
		<nav class="navbar-chulapa-fab-nav" aria-label="primary-navigation">
			<ul class="navbar-nav text-center text-uppercase font-weight-light mt-0 mb-1 py-1">
				<li class="nav-item">
					<a class="nav-link px-3 navbar-brand mx-1 " href="http://localhost:4000/">Home</a>
				</li><li class="nav-item dropdown my-0 py-1"><a class="nav-link dropdown-toggle px-3 py-1 " href="#" id="Part-I:-How-Purple-Teaming-Works" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Part I: How Purple Teaming Works</a>
					<div class="dropdown-menu dropdown-menu-right text-center rounded-0 pr-4" aria-labelledby="Part-I:-How-Purple-Teaming-Works"><a class="dropdown-item nav-link d-block px-3 small " href="http://localhost:4000/part-I/the-basics-of-purple-teaming">1. The Basics of Purple Teaming </a><a class="dropdown-item nav-link d-block px-3 small " href="http://localhost:4000/part-I/offensive-and-defensive-frameworks">2. Offensive and Defensive Frameworks </a><a class="dropdown-item nav-link d-block px-3 small " href="http://localhost:4000/part-I/the-atomic-methodology">3. The Atomic Methodology </a><a class="dropdown-item nav-link d-block px-3 small " href="http://localhost:4000/part-I/the-scenario-based-methodology">4. The Scenario-based Methodology </a></div>
				</li><li class="nav-item dropdown my-0 py-1"><a class="nav-link dropdown-toggle px-3 py-1 " href="#" id="Part-II:-Attack-Emulation-and-Detection-Lab" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Part II: Attack Emulation and Detection Lab</a>
					<div class="dropdown-menu dropdown-menu-right text-center rounded-0 pr-4" aria-labelledby="Part-II:-Attack-Emulation-and-Detection-Lab"><a class="dropdown-item nav-link d-block px-3 small " href="http://localhost:4000/part-II/environment-setup">5. Environment Setup </a><a class="dropdown-item nav-link d-block px-3 small " href="http://localhost:4000/part-II/collecting-telemetry">6. Collecting Telemetry </a><a class="dropdown-item nav-link d-block px-3 small " href="http://localhost:4000/part-II/network-traffic-and-event-tracing">7. Network Traffic and Event Tracing </a><a class="dropdown-item nav-link d-block px-3 small " href="http://localhost:4000/part-II/lotl-with-atomic-red-team">8. Living-off-the-Land with Atomic Red Team </a><a class="dropdown-item nav-link d-block px-3 small " href="http://localhost:4000/part-II/ad-recon-with-mitre-caldera">9. Active Directory Recon with MITRE Caldera </a><a class="dropdown-item nav-link d-block px-3 small " href="http://localhost:4000/part-II/domain-compromise-with-mythic">10. Domain Compromise with Mythic </a></div>
				</li><li class="nav-item dropdown my-0 py-1"><a class="nav-link dropdown-toggle px-3 py-1 " href="#" id="Part-III:-Organizing-an-Exercise" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Part III: Organizing an Exercise</a>
					<div class="dropdown-menu dropdown-menu-right text-center rounded-0 pr-4" aria-labelledby="Part-III:-Organizing-an-Exercise"><a class="dropdown-item nav-link d-block px-3 small " href="http://localhost:4000/part-III/reporting-and-tracking">11. Reporting and Tracking </a><a class="dropdown-item nav-link d-block px-3 small " href="http://localhost:4000/part-III/implementing-a-purple-teaming-function">12. Implementing a Purple Teaming Function </a></div>
				</li><li class="nav-item my-0 py-1">
					<a class="nav-link px-3 py-1" href="http://localhost:4000/resources">Resources</a>
				</li><li class="nav-item my-0 py-1">
					<a class="nav-link px-3 py-1" href="http://localhost:4000/errata">Errata</a>
				</li></ul>
		</nav>
	</div>	<header class="d-flex align-items-center hero-chulapa"><div class="container-lg py-4">
   <h1 class="p-name">The Atomic Methodology</h1>
 </div>
</header>
	<main class="container-lg pb-3 flex-fill">
		<div class="row pt-2">
			<aside class="col-lg-2 mt-lg-3 small"></aside>
			<article id="maincontent" class="col-lg-8 mt-3 e-content">
			<div class="bs-component">
   <div class="progress">
       <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuemin="0" aria-valuemax="100" style="width: 25%; background-color:#eb34e1"></div>
   </div>
</div>
<h2 id="introduction">Introduction</h2>
<p>This chapter introduces the atomic purple teaming methodology. It explores the applications for the methodology, as well as inputs that may help you shape your exercises. The chapter considers what an exercise targeting enumeration of the Domain Admins Active Directory group might look like, and how you can evaluate your test suites to ensure they provide the breadth and depth required.</p>
<p>The chapter considers key metrics to capture when performing your atomic testing, and also highlights micro-emulation as a hybrid form of purple team testing that can help overcome some of the shortfalls of ‘pure’ atomic tests.</p>
<p>The complete test suite produced in this chapter can be found here:</p>
<details>
<summary>Domain Admins enumeration techniques</summary>
<table class="table">
<thead class="thead-light">
   <tr>
     <th scope="col">Test name</th>
     <th scope="col">Command</th>
     <th scope="col">Type</th>
   </tr>
 </thead>
 <tbody>
   <tr>
     <td>A <code>net</code> command with a shortened domain flag</td>
     <td><code>net group "domain admins" /dom</code></td>
     <td><code>net</code></td>
   </tr>
   <tr>
     <td>A <code>net</code> command with a reordered flag</td>
     <td><code>net group /domain "domain admins"</code></td>
     <td><code>net</code></td>
   </tr>
   <tr>
     <td>An obfuscated<br /><code>net</code> command</td>
     <td><code>set GROUP="Domain Admins"</code><br /><code>n^e^t g^r^o^u^p %GROUP% /d^o</code></td>
     <td><code>net</code></td>
   </tr>
   <tr>
     <td>An ADSI searcher script</td>
     <td>
        <code>$Group = [ADSI]"LDAP://CN=Domain Admins, CN=Users, DC=Contoso,DC=com"</code><br />
        <code>$Group.member | ForEach-Object {</code><br />
        <code>$Searcher = [adsisearcher]"(distinguishedname=$_)"</code><br />
        <code>$Searcher.FindOne().Properties.cn</code><br />
        <code>}</code><br />
     </td>
     <td>PowerShell</td>
   </tr>
   <tr>
     <td>An RSAT Active Directory cmdlet</td>
     <td><code>Get-ADGroupMember -Identity "Domain Admins"</code></td>
     <td>PowerShell</td>
   </tr>
   <tr>
     <td>A PowerView command</td>
     <td><code>Get-DomainGroupMember "Domain Admins"</code></td>
     <td>PowerShell</td>
   </tr>
   <tr>
     <td>An AdFind command</td>
     <td>
        <code>AdFind.exe -b "CN=Domain Admins, CN=Users,</code><br />
        <code>    DC=Contoso, DC=com" member</code>
     </td>
     <td>AdFind</td>
   </tr>
   <tr>
     <td>The use of StandIn</td>
     <td>
        <code>execute-assembly /tools/StandIn.exe --group </code><br />
        <code>    "Domain Admins"</code>
     </td>
     <td>In-memory .NET execution</td>
   </tr>
   <tr>
     <td>The use of Ldapsearch</td>
     <td><code>ldapsearch "CN=Domain Admins" member</code></td>
     <td>BOF</td>
   </tr>
   <tr>
     <td>The use of Recon-AD</td>
     <td><code>Recon-AD-Groups Domain Admins</code></td>
     <td>Reflective DLL</td>
   </tr>
   <tr>
     <td>The use of SOCKS with Impacket net.py</td>
     <td>
        <code>socks 8080</code> (on Cobalt Strike beacon)<br />
        <code>proxychains python net.py user:pass@dc group -name “Domain Admins”</code> (on attacker host command line)
     </td>
     <td>SOCKS and Impacket</td>
   </tr>
 </tbody>
</table>
</details>
<hr />
<h2 id="chapter-content">Chapter Content</h2>
<p>This section provides reproductions of the key figures and code snippets seen in this chapter.</p>
<h4 id="scoping-and-dechaining">Scoping and Dechaining</h4>
<figure>
<img src="/assets/images/3/example-attack-chain.png" style="width: 75%" title="Figure 3-1" />
<figcaption>Figure 3-1: An example attack chain that includes initial access, execution, and discovery phases</figcaption>
</figure>
<h4 id="generating-test-cases">Generating Test Cases</h4>
<h5 id="netexe">net.exe</h5>
<p>The complete Sigma rule for detecting reconnaissance performed with the <code class="language-plaintext highlighter-rouge">net.exe</code> and <code class="language-plaintext highlighter-rouge">net1.exe</code> binaries.</p>
<table>
 <tbody>
   <tr>
     <td>Sourced from: <a target="_blank" href="https://github.com/SigmaHQ/sigma/blob/fad4742996c55d8d4663e611f84877a2b741dc46/rules/windows/process_creation/proc_creation_win_net_groups_and_accounts_recon.yml">https://github.com/SigmaHQ/sigma/blob/fad4742996c55d8d4663e611f84877a2b741dc46/rules/windows/process_creation/proc_creation_win_net_groups_and_accounts_recon.yml</a></td>
   </tr>
 </tbody>
</table>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">title</span><span class="pi">:</span> <span class="s">Suspicious Group And Account Reconnaissance Activity Using Net.EXE</span>
<span class="na">id</span><span class="pi">:</span> <span class="s">d95de845-b83c-4a9a-8a6a-4fc802ebf6c0</span>
<span class="na">status</span><span class="pi">:</span> <span class="s">test</span>
<span class="na">description</span><span class="pi">:</span> <span class="pi">|</span>
    <span class="s">Detects suspicious reconnaissance command line activity on Windows systems using Net.EXE</span>
    <span class="s">Check if the user that executed the commands is suspicious (e.g. service accounts, LOCAL_SYSTEM)</span>
<span class="na">references</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">https://redcanary.com/blog/how-one-hospital-thwarted-a-ryuk-ransomware-outbreak/</span>
    <span class="pi">-</span> <span class="s">https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/</span>
    <span class="pi">-</span> <span class="s">https://research.nccgroup.com/2022/08/19/back-in-black-unlocking-a-lockbit-3-0-ransomware-attack/</span>
<span class="na">author</span><span class="pi">:</span> <span class="s">Florian Roth (Nextron Systems), omkar72, @svch0st, Nasreddine Bencherchali (Nextron Systems)</span>
<span class="na">date</span><span class="pi">:</span> <span class="s">2019-01-16</span>
<span class="na">modified</span><span class="pi">:</span> <span class="s">2023-03-02</span>
<span class="na">tags</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">attack.discovery</span>
    <span class="pi">-</span> <span class="s">attack.t1087.001</span>
    <span class="pi">-</span> <span class="s">attack.t1087.002</span>
<span class="na">logsource</span><span class="pi">:</span>
    <span class="na">category</span><span class="pi">:</span> <span class="s">process_creation</span>
    <span class="na">product</span><span class="pi">:</span> <span class="s">windows</span>
<span class="na">detection</span><span class="pi">:</span>
    <span class="na">selection_img</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">Image|endswith</span><span class="pi">:</span>
              <span class="pi">-</span> <span class="s1">'</span><span class="s">\net.exe'</span>
              <span class="pi">-</span> <span class="s1">'</span><span class="s">\net1.exe'</span>
        <span class="pi">-</span> <span class="na">OriginalFileName</span><span class="pi">:</span>
              <span class="pi">-</span> <span class="s1">'</span><span class="s">net.exe'</span>
              <span class="pi">-</span> <span class="s1">'</span><span class="s">net1.exe'</span>
    <span class="c1"># Covers group and localgroup flags</span>
    <span class="na">selection_group_root</span><span class="pi">:</span>
        <span class="na">CommandLine|contains</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="nv"> </span><span class="s">group</span><span class="nv"> </span><span class="s">'</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="nv"> </span><span class="s">localgroup</span><span class="nv"> </span><span class="s">'</span>
    <span class="na">selection_group_flags</span><span class="pi">:</span>
        <span class="na">CommandLine|contains</span><span class="pi">:</span>
            <span class="c1"># Add more groups for other languages</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">domain</span><span class="nv"> </span><span class="s">admins'</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="nv"> </span><span class="s">administrator'</span> <span class="c1"># Typo without an 'S' so we catch both</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="nv"> </span><span class="s">administrateur'</span> <span class="c1"># Typo without an 'S' so we catch both</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">enterprise</span><span class="nv"> </span><span class="s">admins'</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">Exchange</span><span class="nv"> </span><span class="s">Trusted</span><span class="nv"> </span><span class="s">Subsystem'</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">Remote</span><span class="nv"> </span><span class="s">Desktop</span><span class="nv"> </span><span class="s">Users'</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">Utilisateurs</span><span class="nv"> </span><span class="s">du</span><span class="nv"> </span><span class="s">Bureau</span><span class="nv"> </span><span class="s">à</span><span class="nv"> </span><span class="s">distance'</span> <span class="c1"># French for "Remote Desktop Users"</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="s">Usuarios</span><span class="nv"> </span><span class="s">de</span><span class="nv"> </span><span class="s">escritorio</span><span class="nv"> </span><span class="s">remoto'</span> <span class="c1"># Spanish for "Remote Desktop Users"</span>
            <span class="pi">-</span> <span class="s1">'</span><span class="nv"> </span><span class="s">/do'</span> <span class="c1"># short for domain</span>
    <span class="na">filter_group_add</span><span class="pi">:</span>
        <span class="c1"># This filter is added to avoid the potential case where the point is not recon but addition</span>
        <span class="na">CommandLine|contains</span><span class="pi">:</span> <span class="s1">'</span><span class="nv"> </span><span class="s">/add'</span>
    <span class="c1"># Covers 'accounts' flag</span>
    <span class="na">selection_accounts_root</span><span class="pi">:</span>
        <span class="na">CommandLine|contains</span><span class="pi">:</span> <span class="s1">'</span><span class="nv"> </span><span class="s">accounts</span><span class="nv"> </span><span class="s">'</span>
    <span class="na">selection_accounts_flags</span><span class="pi">:</span>
        <span class="na">CommandLine|contains</span><span class="pi">:</span> <span class="s1">'</span><span class="nv"> </span><span class="s">/do'</span> <span class="c1"># short for domain</span>
    <span class="na">condition</span><span class="pi">:</span> <span class="s">selection_img and ((all of selection_group_* and not filter_group_add) or all of selection_accounts_*)</span>
<span class="na">falsepositives</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">Inventory tool runs</span>
    <span class="pi">-</span> <span class="s">Administrative activity</span>
<span class="na">level</span><span class="pi">:</span> <span class="s">medium</span>
</code></pre></div></div>
<h5 id="powershell">PowerShell</h5>
<p>A code snippet to enumerate Domain Admin members with PowerShell:</p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$Group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">ADSI</span><span class="p">]</span><span class="s2">"LDAP://CN=Domain Admins,CN=Users,DC=Contoso,DC=com"</span><span class="w">
</span><span class="nv">$Group</span><span class="o">.</span><span class="nf">member</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ForEach-Object</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nv">$Searcher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">adsisearcher</span><span class="p">]</span><span class="s2">"(distinguishedname=</span><span class="bp">$_</span><span class="s2">)"</span><span class="w">
    </span><span class="nv">$Searcher</span><span class="o">.</span><span class="nf">FindOne</span><span class="p">()</span><span class="o">.</span><span class="nf">Properties</span><span class="o">.</span><span class="nf">cn</span><span class="w"> 
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
<p>Domain enumeration via the Active Directory PowerShell module:</p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Get-ADGroupMember</span><span class="w"> </span><span class="nt">-Identity</span><span class="w"> </span><span class="s2">"Domain Admins"</span><span class="w">
</span></code></pre></div></div>
<p>Use of PowerSploit to enumerate Domain Admins:</p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Get-DomainGroupMember</span><span class="w"> </span><span class="s2">"Domain Admins"</span><span class="w">
</span></code></pre></div></div>
<h4 id="evaluating-test-suites">Evaluating Test Suites</h4>
<h5 id="attack-sophistication">Attack Sophistication</h5>
<figure>
<img src="/assets/images/3/attack-sophistication-pyramid.png" style="width: 75%" title="Figure 3-2" />
<figcaption>Figure 3-2: Attack techniques arranged in a pyramid of sophistication and prevalence</figcaption>
</figure>
<h4 id="plotting-results">Plotting Results</h4>
<figure>
<img src="/assets/images/3/graph-strong-tel.png" style="width: 75%" title="Figure 3-3" />
<figcaption>Figure 3-3: Atomic purple team results plotted with a strong telemetry score</figcaption>
</figure>
<figure>
<img src="/assets/images/3/graph-strong-prev.png" style="width: 75%" title="Figure 3-4" />
<figcaption>Figure 3-4: Atomic purple team with a strong prevention score</figcaption>
</figure>
<figure>
<img src="/assets/images/3/graph-tap-across-phases.png" style="width: 75%" title="Figure 3-5" />
<figcaption>Figure 3-5: Atomic purple team results plotted on a graph across multiple ATT&amp;CK tactics</figcaption>
</figure>
<figure>
<img src="/assets/images/3/graph-alerting-pot.png" style="width: 75%" title="Figure 3-6" />
<figcaption>Figure 3-6: Capturing the alerting potential</figcaption>
</figure>
<hr />
<h2 id="resources">Resources</h2>
<p>The following resources expand on topics covered in this chapter.
<br />
<br /></p>
<h4 id="applications-of-atomic-purple-teaming">Applications of Atomic Purple Teaming</h4>
<div class="row row-cols-1 row-cols-md-1">
   <div class="col mb-4">
       <div class="card">
           <div class="card-body">
               <h6>Techniques for breaking out of Citrix environments</h6>
               <p><i>Michael Yardley, "Breaking Out of Citrix and other Restricted Desktop Environments," Pen Test Partners, June 6, 2014</i></p>
                <a target="_blank" href="https://www.pentestpartners.com/security-blog/breaking-out-of-citrix-and-other-restricted-desktop-environments/" class="btn btn-primary" style="background-color:#eb34e1">Read More</a>
           </div>
       </div>
   </div>
</div>
<h4 id="scoping-and-dechaining-1">Scoping and Dechaining</h4>
<div class="row row-cols-1 row-cols-md-1">
   <div class="col mb-4">
       <div class="card">
           <div class="card-body">
               <h6>Examples of the many techniques for performing HTML smuggling</h6>
               <p><i>Alfie Champion, "HTML Smuggling: Recent observations of threat actor techniques," delivr.to, January 6, 2023</i></p>
                <a target="_blank" href="https://blog.delivr.to/html-smuggling-recent-observations-of-threat-actor-techniques-74501d5c8a06" class="btn btn-primary" style="background-color:#eb34e1">Read More</a>
           </div>
       </div>
   </div>
   <div class="col mb-4">
       <div class="card">
           <div class="card-body">
               <h6>Operational considerations and technical implementation details of environmental keying and execution guardrails</h6>
               <p><i>Brandon McGrath, "Execution Guardrails: No One Likes Unintentional Exposure," TrustedSec, August 6, 2024</i></p>
                <a target="_blank" href="https://trustedsec.com/blog/execution-guardrails-no-one-likes-unintentional-exposure" class="btn btn-primary" style="background-color:#eb34e1">Read More</a>
           </div>
       </div>
   </div>
</div>
<h4 id="inputs">Inputs</h4>
<div class="row row-cols-1 row-cols-md-1">
   <div class="col mb-4">
       <div class="card">
           <div class="card-body">
               <h6>A whitepaper covering the extensive abuse potential of misconfigured Active Directory Certificate Services (ADCS)</h6>
               <p><i>Will Schroeder, Lee Chagolla-Christensen, "Certified Pre-Owned," SpecterOps, June 22, 2022</i></p>
                <a target="_blank" href="https://specterops.io/wp-content/uploads/sites/3/2022/06/Certified_Pre-Owned.pdf" class="btn btn-primary" style="background-color:#eb34e1">Read More</a>
           </div>
       </div>
   </div>
   <div class="col mb-4">
       <div class="card">
           <div class="card-body">
               <h6>A collection of post-exploitation techniques targeting components of the identify provider, Okta</h6>
               <p><i>Adam Chester, "Okta for Red Teamers," TrustedSec, September 18, 2023</i></p>
                <a target="_blank" href="https://trustedsec.com/blog/okta-for-red-teamers" class="btn btn-primary" style="background-color:#eb34e1">Read More</a>
           </div>
       </div>
   </div>
</div>
<h4 id="generating-test-cases-1">Generating Test Cases</h4>
<div class="row row-cols-1 row-cols-md-1">
   <div class="col mb-4">
       <div class="card">
           <div class="card-body">
               <h6>Examples of command line obfuscation techniques</h6>
               <p><i>Daniel Bohannon, "DOSfuscation: Exploring the Depths of Cmd.exe Obfuscation and Detection Techniques," Mandiant, 2019</i></p>
                <a target="_blank" href="https://www.mandiant.com/media/22686" class="btn btn-primary" style="background-color:#eb34e1">Read More</a>
           </div>
       </div>
   </div>
   <div class="col mb-4">
       <div class="card">
           <div class="card-body">
               <h6>A Sigma rule to detect the enumeration of high value groups like enterprise and domain administrators via the built-in net.exe executable</h6>
               <p><i>Florian Roth, omkar72, @svch0st, Nasreddine Bencherchali, "proc_creation_win_net_groups_and_accounts_recon.yml", GitHub, accessed January 12, 2025</i></p>
                <a target="_blank" href="https://github.com/SigmaHQ/sigma/blob/fad4742996c55d8d4663e611f84877a2b741dc46/rules/windows/process\_creation/proc\_creation\_win\_net\_groups\_and\_accounts\_recon.yml" class="btn btn-primary" style="background-color:#eb34e1">Read More</a>
           </div>
       </div>
   </div>
   <div class="col mb-4">
       <div class="card">
           <div class="card-body">
               <h6>An overview of detection and prevention mechanisms introduced by Microsoft in Windows PowerShell version 5 and onwards</h6>
               <p><i>"PowerShell loves the Blue Team," Microsoft, June 9, 2015</i></p>
                <a target="_blank" href="https://devblogs.microsoft.com/powershell/powershell-the-blue-team/" class="btn btn-primary" style="background-color:#eb34e1">Read More</a>
           </div>
       </div>
   </div>
   <div class="col mb-4">
       <div class="card">
           <div class="card-body">
               <h6>An overview of the architecture and impact of the Antimalware Scan Interface</h6>
               <p><i>"How the Antimalware Scan Interface (AMSI) helps you defend against malware," Microsoft, August 23, 2019</i></p>
                <a target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/amsi/how-amsi-helps" class="btn btn-primary" style="background-color:#eb34e1">Read More</a>
           </div>
       </div>
   </div>
   <div class="col mb-4">
       <div class="card">
           <div class="card-body">
               <h6>Introducing <code>execute-assembly</code> to Cobalt Strike</h6>
               <p><i>Raphael Mudge, "Cobalt Strike 3.11 – The snake that eats its tail," Cobalt Strike, April 9, 2018</i></p>
                <a target="_blank" href="https://www.cobaltstrike.com/blog/cobalt-strike-3-11-the-snake-that-eats-its-tail" class="btn btn-primary" style="background-color:#eb34e1">Read More</a>
           </div>
       </div>
   </div>
   <div class="col mb-4">
       <div class="card">
           <div class="card-body">
               <h6>Introducing <i>Beacon Object Files</i> to Cobalt Strike v4.1</h6>
               <p><i>Raphael Mudge, "Cobalt Strike 4.1 – The Mark of Injection," Cobalt Strike, June 25, 2020</i></p>
                <a target="_blank" href="https://www.cobaltstrike.com/blog/cobalt-strike-4-1-the-mark-of-injection" class="btn btn-primary" style="background-color:#eb34e1">Read More</a>
           </div>
       </div>
   </div>
</div>
<h4 id="evaluating-test-suites-1">Evaluating Test Suites</h4>
<div class="row row-cols-1 row-cols-md-1">
   <div class="col mb-4">
       <div class="card">
           <div class="card-body">
               <h6>Introducing the concept of capability abstraction</h6>
               <p><i>Jared Atkinson, "Capability Abstraction," SpecterOps, Feb 6, 2020</i></p>
                <a target="_blank" href="https://posts.specterops.io/capability-abstraction-fbeaeeb26384" class="btn btn-primary" style="background-color:#eb34e1">Read More</a>
           </div>
       </div>
   </div>
</div>
<h4 id="plotting-results-1">Plotting Results</h4>
<div class="row row-cols-1 row-cols-md-1">
   <div class="col mb-4">
       <div class="card">
           <div class="card-body">
               <h6>Guidance on the detection and prevention of web shell malware</h6>
               <p><i>Australian Signals Directorate, "Detect and Prevent Web Shell Malware," Australian Signals Directorate, June 9, 2020</i></p>
                <a target="_blank" href="https://media.defense.gov/2020/Jun/09/2002313081/-1/-1/0/CSI-DETECT-AND-PREVENT-WEB-SHELL-MALWARE-20200422.PDF" class="btn btn-primary" style="background-color:#eb34e1">Read More</a>
           </div>
       </div>
   </div>
</div>
<h4 id="micro-emulation">Micro-Emulation</h4>
<div class="row row-cols-1 row-cols-md-1">
   <div class="col mb-4">
       <div class="card">
           <div class="card-body">
               <h6>Release of the micro-emulation framework from the Center for Threat-informed Defense</h6>
               <p><i>Mike Cunningham and Jamie Williams, "Ahhh, This Emulation is Just Right: Introducing Micro Emulation Plans," September 15, 2022</i></p>
                <a target="_blank" href="https://medium.com/mitre-engenuity/ahhh-this-emulation-is-just-right-introducing-micro-emulation-plans-7bf4c26451d3" class="btn btn-primary" style="background-color:#eb34e1">Read More</a>
           </div>
       </div>
   </div>
   <div class="col mb-4">
       <div class="card">
           <div class="card-body">
               <h6>A micro-emulation plan replicating web shell activity</h6>
               <p><i>"Micro Emulation Plan: Web Shells", GitHub, accessed January 12, 2025</i></p>
                <a target="_blank" href="https://github.com/center-for-threat-informed-defense/adversary_emulation_library/tree/9786a3297c855ea8dfa6c321befa397473b32f41/micro_emulation_plans/src/webshell" class="btn btn-primary" style="background-color:#eb34e1">Read More</a>
           </div>
       </div>
   </div>
   <div class="col mb-4">
       <div class="card">
           <div class="card-body">
               <h6>A micro-emulation plan replicating the popular C2 framework technique <i>Fork-n-Run</i></h6>
               <p><i>"Micro Emulation Plan: Named Pipes", GitHub, accessed January 12, 2025</i></p>
                <a target="_blank" href="https://github.com/center-for-threat-informed-defense/adversary_emulation_library/tree/9786a3297c855ea8dfa6c321befa397473b32f41/micro_emulation_plans/src/named_pipes" class="btn btn-primary" style="background-color:#eb34e1">Read More</a>
           </div>
       </div>
   </div>
   <div class="col mb-4">
       <div class="card">
           <div class="card-body">
               <h6>A micro-emulation plan replicating Active Directory enumeration through LDAP queries, Windows APIs and built-in executables</h6>
               <p><i>"Micro Emulation Plan: Active Directory Enumeration", GitHub, accessed January 12, 2025</i></p>
                <a target="_blank" href="https://github.com/center-for-threat-informed-defense/adversary_emulation_library/tree/9786a3297c855ea8dfa6c321befa397473b32f41/micro_emulation_plans/src/ad_enum" class="btn btn-primary" style="background-color:#eb34e1">Read More</a>
           </div>
       </div>
   </div>
   <div class="col mb-4">
       <div class="card">
           <div class="card-body">
               <h6>A micro-emulation plan replicating user-driven execution of an initial access payload that could be delivered via phishing</h6>
               <p><i>"Micro Emulation Plan: User Execution", GitHub, accessed January 12, 2025</i></p>
                <a target="_blank" href="https://github.com/center-for-threat-informed-defense/adversary_emulation_library/blob/9786a3297c855ea8dfa6c321befa397473b32f41/micro_emulation_plans/src/user_execution/README_user_execution.md" class="btn btn-primary" style="background-color:#eb34e1">Read More</a>
           </div>
       </div>
   </div>
   <div class="col mb-4">
       <div class="card">
           <div class="card-body">
               <h6>Demonstration of IcedID malware delivery via an ISO disk image file, designed to bypass Mark of the Web</h6>
               <p><i>"Malicious ISO File Leads to Domain Wide Ransomware", The DFIR Report, April 3, 2023</i></p>
                <a target="_blank" href="https://thedfirreport.com/2023/04/03/malicious-iso-file-leads-to-domain-wide-ransomware/" class="btn btn-primary" style="background-color:#eb34e1">Read More</a>
           </div>
       </div>
   </div>
   <div class="col mb-4">
       <div class="card">
           <div class="card-body">
               <h6>Another example of disk image based initial compromise to delivery QakBot malware</h6>
               <p><i>"Surge of QakBot Activity Using Malspam, Malicious XLSB Files", Center for Internet Security, accessed January 12, 2025</i></p>
                <a target="_blank" href="https://www.cisecurity.org/insights/blog/surge-of-qakbot-activity-using-malspam-malicious-xlsb-files" class="btn btn-primary" style="background-color:#eb34e1">Read More</a>
           </div>
       </div>
   </div>
   <div class="col mb-4">
       <div class="card">
           <div class="card-body">
               <h6>Bumblebee malware infection achieved via an LNK and DLL file contained in an ISO disk image</h6>
               <p><i>"Malicious ISO File Leads to Domain Wide Ransomware", The DFIR Report, September 26, 2022</i></p>
                <a target="_blank" href="https://thedfirreport.com/2022/09/26/bumblebee-round-two" class="btn btn-primary" style="background-color:#eb34e1">Read More</a>
           </div>
       </div>
   </div>
   <div class="col mb-4">
       <div class="card">
           <div class="card-body">
               <h6>An article covering a Microsoft 'Patch Tuesday' in which the Mark of the Web bypass for ISO disk images was patched</h6>
               <p><i>"Microsoft fixes Windows zero-day bug exploited to push malware", BleepingComputer, November 22, 2022</i></p>
                <a target="_blank" href="https://www.bleepingcomputer.com/news/microsoft/microsoft-fixes-windows-zero-day-bug-exploited-to-push-malware/" class="btn btn-primary" style="background-color:#eb34e1">Read More</a>
           </div>
       </div>
   </div>
</div>
<div class="container">
 <div class="row">
   <div class="col" style="text-align: left">
      <a href="/part-I/offensive-and-defensive-frameworks/" class="btn btn-primary">&lt;&lt; Chapter 2</a>
   </div>
   <div class="col" style="text-align: right">
      <a href="/part-I/the-scenario-based-methodology/" class="btn btn-primary">Chapter 4 &gt;&gt;</a>
   </div>
 </div>
</div>
			</article>
		</div>
	</main>
		<!-- Footer -->
 <footer class="footer-chulapa text-center mt-0 pt-3">
   <div class="container">
     <div class="row">
       <div class="col-xl-10 offset-xl-1"><div role="navigation" class="d-flex flex-wrap justify-content-center"><a href="https://github.com/orgs/aguidetopurpleteaming" title="footerRepo on Github" class="chulapa-footer-sociallink lead"><span class="fa-stack fa-lg" aria-hidden="true">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fab fa-github fa-stack-1x fa-inverse"></i>
              </span><span class="sr-only">Repo on Github</span>
            </a></div><p class="mt-2 mb-3">&copy; 2025 ajpc500</p>
          <!-- Do not remove this in order to give  attributions -->
         <p class="chulapa-footer-brand">Powered by <a href="https://dieghernan.github.io/chulapa"> <span class="chulapa">Chulapa</span> Jekyll Theme</a><br><b>Lux</b> skin by <a href="https://bootswatch.com/">Bootswatch</a></p>
          <!-- End  attributions -->
       </div>
     </div>
 </div>
</footer>
<!-- Footer -->
<!-- JS, Popper.js, and jQuery -->
	<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/gh/dieghernan/chulapa@master/assets/js/chulapa_script.js"></script>
	<!-- start custom scripts to be placed at the bottom of the page -->
<!-- end custom bottom scripts -->
	</body>
</html>
